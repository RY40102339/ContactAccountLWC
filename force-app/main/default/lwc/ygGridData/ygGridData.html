<!--
*******************************************************************************************************
* (C) Copyright 2020 Yokogawa. All rights reserved.
* This code is property of Yokogawa. Use, duplication and
* disclosure in any form without permission of copyright holder is prohibited.
* 
******************************************************************************************************* 
* @author Selvaraj Thangaraj
* @version 1.0
* @created 05/08/2020
* @description 
* This component is used for the displaying the grid details in UI.
*
* *
*  Change History:
*  MM/DD/YYYY			Developer Name			Comments
*  
*  
*
*-->

<template>
    <template if:true={isLoading}>
        <div class="loading">
            <div class="loading-txt">
                <div class="row text-center">
                    <div class="col-lg-12">
                        <svg width="51" height="52" viewBox="0 0 51 52" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M0.410156 25.1209C11.2022 31.0632 20.0171 40.1454 25.6268 51.1329L25.6109 51.1349C31.2146 40.1493 40.0255 31.0692 50.8116 25.1249L50.7937 25.1407L25.6208 0L0.434001 25.1407L0.410156 25.1209Z"
                                fill="#FFEE00"></path>
                        </svg>
                    </div>
                    <div class="col-lg-12 mt-3" style="margin-top: 1rem !important;">
                        <div class="spinner-border text-dark"></div>
                        <div class="txt-load">Loading..</div>
                    </div>
                </div>
            </div>
        </div>
    </template>
    <div class="row">
        <div class="section">
            <div class="col-lg-12">
                <div class="row">
                    <div class="col-lg-12 mt-32 mb-6 download-csv text-right">
                        <div class="f12 d-inline-block serial-api">
                            <a href={productregURL} style="padding-right: 2.5rem;"
                                class="text-right blue-primary text-hover-underline">{label.regProductLbl}</a>
                        </div>
                        <div class="f12 d-inline-block">
                            <a href="javascript:void(0)" style="padding-right: 2.5rem;"
                                class="text-right blue-primary text-hover-underline" onclick={downloadCSVFile}>
                                {downloadLink}
                                <img src={csvIcon} alt="CSV icon" class="ml-2" />
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-12">
                <template if:true={products}>
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="table-responsive mb-5 pb-2">
                                <template if:true={isgridLoading}>
                                    <div class="col-lg-12 text-center mt-3">
                                        <div class="spinner-border text-dark"></div>
                                        <div class="txt-load">Loading..</div>
                                    </div>
                                </template>
                                <template if:false={isgridLoading}>
                                    <table lwc:dom="manual" class="table table-borderless f14 mb-5 all-prod-dtTable">
                                    </table>
                                </template>
                            </div>
                        </div>
                    </div>
                </template>
                <template if:true={showLoadMore}>
                    <div class="row">
                        <div class="col-lg-12 text-center mt-3 mb-1 loading-icon d-none">
                            <div class="spinner-border text-dark"></div>
                            <div class="txt-load">Loading..</div>
                        </div>
                        <div class="col-lg-12 load-more pl-0 mt-lg-3 mb-5 d-flex justify-content-center">
                            <button onclick={loadmore} class="f14 fbold blue-primary">
                                <svg width="8" height="12" viewBox="0 0 8 12" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path d="M2 10L6 6L2 2" stroke="#004F9B" stroke-width="2" stroke-linecap="square">
                                    </path>
                                </svg>
                                {label.showLbl} {remainRecords} {label.moreProductsLbl}
                            </button>
                        </div>
                    </div>
                </template>
            </div>
        </div>
    </div>
    <!--Use template if:true to display/hide popup based on isModalOpen value-->
    <template if:true={isModalOpen}>
        <!-- Modal/Popup Box LWC starts here -->
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
            aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
                <!-- Modal/Popup Box LWC header here -->
                <header class="slds-modal__header h-60 border-0 rounded-0">
                    <button
                        class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse border-0 shadow-none"
                        title="Close" onclick={closeModal}>
                        <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M8 8L24 24M40 40L24 24M24 24L40 8L8 40" stroke="#004F9B" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round"></path>
                        </svg>
                        <span class="slds-assistive-text">Close</span>
                    </button>
                </header>
                <!-- Modal/Popup Box LWC body starts here -->
                <div class="slds-modal__content slds-p-around_medium radius-0" id="modal-content-id-1">
                    <div class="row mb-3">
                        <div class="col-lg-12">
                            <h2 id="modal-heading-01-16" style="position: absolute;top: -75px;"
                                class="slds-text-heading_medium slds-hyphenate mx-sm-3 noto-font f18">Search serial
                                number and register</h2>
                        </div>
                        <div class="col-lg-12">
                            <div class="form-inline">
                                <div class="form-group mx-sm-3 mb-2">
                                    <label for="serialNo" class="sr-only">Search Serial Number</label>
                                    <input type="text" class="form-control serial-no f14" id="serialNo"
                                        placeholder="Search Serial Number" maxlength="11">
                                </div>
                                <button type="button" class="btn btn-primary btn-sm mb-1 search-btn"
                                    onclick={submitSerial}>Search</button>
                                <button type="button" class="btn btn-primary btn-sm mb-1 d-none regis-btn ml-2"
                                    onclick={submitRegister}>Register</button>
                                <div class="invalid-feedback mx-sm-3 d-block">
                                    <i class="fas fa-exclamation-circle d-none"></i> {errorMsg}
                                </div>
                            </div>

                            <div class="valid-feedback mx-sm-3 d-none f18 noto-font"
                                style="top: -25px;position: relative; font-weight: 400;">
                                <i class="fas fa-check-circle"></i> {successMsg} <br />
                                <button type="button" onclick={closeModal} class="btn btn-primary btn-sm"
                                    style="position: absolute;left: 260px;top: 35px;">Ok</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </template>
</template>